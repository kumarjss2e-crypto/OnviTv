# Subscription System - Architecture & Flow Diagrams

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        OnviTV App                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  AuthProvider (Authentication)                           â”‚  â”‚
â”‚  â”‚  - Manages user login/logout                             â”‚  â”‚
â”‚  â”‚  - Handles Firebase Auth                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â”‚                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  SubscriptionProvider (Subscription State)              â”‚  â”‚
â”‚  â”‚  - Tracks: isPremium, isFreeTier, subscription          â”‚  â”‚
â”‚  â”‚  - Functions: upgrade(), cancel(), refresh()            â”‚  â”‚
â”‚  â”‚  - Loads subscription from Firebase on mount            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â”‚                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Navigation Stack                                        â”‚  â”‚
â”‚  â”‚  â”œâ”€ SplashScreen          (shows upgrade prompt)         â”‚  â”‚
â”‚  â”‚  â”œâ”€ LoginScreen            (user auth)                   â”‚  â”‚
â”‚  â”‚  â”œâ”€ PremiumUpgradeScreen   (upgrade UI)                  â”‚  â”‚
â”‚  â”‚  â”œâ”€ Main (Tabs)            (home app)                    â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ HomeScreen                                       â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ LiveTVScreen                                     â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ EPGScreen                                        â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ MoreScreen                                       â”‚  â”‚
â”‚  â”‚  â”œâ”€ VideoPlayerScreen (shows reward ad)                 â”‚  â”‚
â”‚  â”‚  â”œâ”€ RewardAdScreen    (ad playback)                     â”‚  â”‚
â”‚  â”‚  â””â”€ More screens...                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â”‚                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Feature Hooks                                           â”‚  â”‚
â”‚  â”‚  â”œâ”€ usePremiumUpgradePrompt()                            â”‚  â”‚
â”‚  â”‚  â”œâ”€ useFreeUserLimitations()                             â”‚  â”‚
â”‚  â”‚  â””â”€ useFreeUserAds()                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â”‚                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Firebase Integration                                    â”‚  â”‚
â”‚  â”‚  â”œâ”€ subscriptionService.js                              â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ getUserSubscription()                            â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ upgradeSubscription()                            â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ cancelSubscription()                             â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ isPremiumUser()                                  â”‚  â”‚
â”‚  â”‚  â””â”€ Firestore: /subscriptions/{userId}                 â”‚  â”‚
â”‚  â”‚     â””â”€ Firestore: /payments/{paymentId}                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## User Flow: Free User After Login

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Logs In   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Auth Check: User Valid? â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ YES
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Load Subscription Info  â”‚
â”‚  from Firebase           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Check: Premium?         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ NO  â”‚ YES
         â–¼     â–¼
    FREE USER  PREMIUM USER
         â”‚            â”‚
         â–¼            â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚Show Upgrade  â”‚  â”‚ Go to Main   â”‚
  â”‚Screen        â”‚  â”‚ (No Ads)     â”‚
  â”‚(Plan Pricing)â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚Features      â”‚
  â”‚Compare       â”‚
  â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
     â”‚       â”‚
  Continue  Upgrade
  Free  (Payment)
     â”‚       â”‚
     â””â”€â”€â”€â”¬â”€â”€â”€â”˜
         â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Main App       â”‚
  â”‚  Free: Limited  â”‚
  â”‚  Premium: Full  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## User Flow: Free User Watching Video

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Clicks on Video    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VideoPlayerScreen       â”‚
â”‚  Check: Premium?         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ NO  â”‚ YES
         â–¼     â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚Show Reward  â”‚  â”‚ Play Video   â”‚
  â”‚Ad Screen    â”‚  â”‚ Immediately  â”‚
  â”‚(30 seconds) â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
     â”‚      â”‚
  Watch   Skip
  Ad      (Back)
     â”‚      â”‚
     â””â”€â”€â”€â”¬â”€â”€â”˜
         â–¼
    Play Video
```

---

## Subscription Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SubscriptionContext
â”‚  (Global State)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ subscription: {...}â”‚
â”‚ isPremium: bool    â”‚
â”‚ isFreeTier: bool   â”‚
â”‚ loading: bool      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                              â”‚
    â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ subscriptionService â”‚    â”‚ subscriptionHooks    â”‚
â”‚ Firebase Logic      â”‚    â”‚ Feature Restrictions â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ getUserSub()        â”‚    â”‚ useFreeUserAds()     â”‚
â”‚ upgradeSubscription â”‚    â”‚ useFreeUserLimits()  â”‚
â”‚ cancelSubscription()â”‚    â”‚ usePremiumPrompt()   â”‚
â”‚ isPremiumUser()     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Firebase         â”‚
   â”‚ /subscriptions/  â”‚
   â”‚ {userId}         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Plan Selection Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PremiumUpgradeScreen            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Free Plan                  â”‚ â”‚
â”‚  â”‚ â”œâ”€ Price: $0               â”‚ â”‚
â”‚  â”‚ â”œâ”€ Downloads: 5/month      â”‚ â”‚
â”‚  â”‚ â”œâ”€ Quality: SD             â”‚ â”‚
â”‚  â”‚ â””â”€ Ads: Yes                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Premium Monthly [SELECTED] â”‚ â”‚ (Green border)
â”‚  â”‚ â”œâ”€ Price: $9.99/month      â”‚ â”‚
â”‚  â”‚ â”œâ”€ Downloads: Unlimited    â”‚ â”‚
â”‚  â”‚ â”œâ”€ Quality: 4K             â”‚ â”‚
â”‚  â”‚ â””â”€ Ads: No                 â”‚ â”‚
â”‚  â”‚ [âœ“ Selected]               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Premium Yearly             â”‚ â”‚
â”‚  â”‚ â”œâ”€ Price: $99.99/year      â”‚ â”‚
â”‚  â”‚ â”œâ”€ Downloads: Unlimited    â”‚ â”‚
â”‚  â”‚ â”œâ”€ Quality: 4K             â”‚ â”‚
â”‚  â”‚ â”œâ”€ Ads: No                 â”‚ â”‚
â”‚  â”‚ â””â”€ ğŸ·ï¸ SAVE 17%!             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Comparison Table           â”‚ â”‚
â”‚  â”‚ Feature | Free | Premium   â”‚ â”‚
â”‚  â”‚ Streams | Limit| Unlimited â”‚ â”‚
â”‚  â”‚ Quality | SD   | 4K        â”‚ â”‚
â”‚  â”‚ Ads     | Yes  | No        â”‚ â”‚
â”‚  â”‚ Support | Comm | Priority  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                  â”‚
â”‚  [UPGRADE NOW] [CONTINUE FREE]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Reward Ad Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RewardAdScreen                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                â”‚
â”‚  Loading Ad...                 â”‚
â”‚  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ (50%)     â”‚
â”‚                                â”‚
â”‚  [spinning icon]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ (1.5 seconds)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RewardAdScreen                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    Ad Content Goes Here  â”‚  â”‚
â”‚  â”‚  (Your Advertisement)    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚         â”‚ â±ï¸ 30 SECONDS â”‚        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                â”‚
â”‚  This ad unlocks video stream  â”‚
â”‚  for 1 hour.                   â”‚
â”‚                                â”‚
â”‚  [SKIP IN 30S]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ (countdown)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RewardAdScreen                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚         â”‚ â±ï¸ 10 SECONDS â”‚        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                â”‚
â”‚  Video will play after ad      â”‚
â”‚                                â”‚
â”‚  [SKIP IN 10S]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ (countdown)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RewardAdScreen                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚         â”‚ âœ… 00 SECONDS â”‚        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                â”‚
â”‚  âœ… Ad completed!              â”‚
â”‚                                â”‚
â”‚  [WATCH VIDEO NOW]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VideoPlayerScreen             â”‚
â”‚  (Video Plays)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Firebase Structure

```
Firestore Database
â”‚
â”œâ”€â”€ subscriptions (collection)
â”‚   â”‚
â”‚   â”œâ”€â”€ user123 (document)
â”‚   â”‚   â”œâ”€â”€ plan: "free"
â”‚   â”‚   â”œâ”€â”€ status: "active"
â”‚   â”‚   â”œâ”€â”€ startDate: 2025-11-21T10:30:00Z
â”‚   â”‚   â”œâ”€â”€ renewalDate: null
â”‚   â”‚   â”œâ”€â”€ paymentId: null
â”‚   â”‚   â”œâ”€â”€ paymentMethod: null
â”‚   â”‚   â””â”€â”€ createdAt: 2025-11-21T10:30:00Z
â”‚   â”‚
â”‚   â”œâ”€â”€ user456 (document)
â”‚   â”‚   â”œâ”€â”€ plan: "premium_monthly"
â”‚   â”‚   â”œâ”€â”€ status: "active"
â”‚   â”‚   â”œâ”€â”€ startDate: 2025-11-21T10:30:00Z
â”‚   â”‚   â”œâ”€â”€ renewalDate: 2025-12-21T10:30:00Z
â”‚   â”‚   â”œâ”€â”€ paymentId: "pi_1234567890"
â”‚   â”‚   â”œâ”€â”€ paymentMethod: "card"
â”‚   â”‚   â”œâ”€â”€ amount: 9.99
â”‚   â”‚   â””â”€â”€ createdAt: 2025-11-21T10:30:00Z
â”‚   â”‚
â”‚   â””â”€â”€ user789 (document)
â”‚       â”œâ”€â”€ plan: "premium_yearly"
â”‚       â”œâ”€â”€ status: "active"
â”‚       â”œâ”€â”€ startDate: 2025-11-21T10:30:00Z
â”‚       â”œâ”€â”€ renewalDate: 2026-11-21T10:30:00Z
â”‚       â”œâ”€â”€ paymentId: "pi_9876543210"
â”‚       â”œâ”€â”€ paymentMethod: "card"
â”‚       â”œâ”€â”€ amount: 99.99
â”‚       â””â”€â”€ createdAt: 2025-11-21T10:30:00Z
â”‚
â””â”€â”€ payments (collection)
    â”‚
    â”œâ”€â”€ pi_1234567890 (document)
    â”‚   â”œâ”€â”€ userId: "user456"
    â”‚   â”œâ”€â”€ amount: 9.99
    â”‚   â”œâ”€â”€ plan: "premium_monthly"
    â”‚   â”œâ”€â”€ status: "completed"
    â”‚   â””â”€â”€ createdAt: 2025-11-21T10:30:00Z
    â”‚
    â””â”€â”€ pi_9876543210 (document)
        â”œâ”€â”€ userId: "user789"
        â”œâ”€â”€ amount: 99.99
        â”œâ”€â”€ plan: "premium_yearly"
        â”œâ”€â”€ status: "completed"
        â””â”€â”€ createdAt: 2025-11-21T10:30:00Z
```

---

## Hook Usage Patterns

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ usePremiumUpgradePrompt()                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Returns: { showUpgradePrompt, setShowUpgradePrompt }
â”‚                                                   â”‚
â”‚ Usage:                                            â”‚
â”‚   if (user && showUpgradePrompt) {               â”‚
â”‚     return <PremiumUpgradeScreen />;             â”‚
â”‚   }                                               â”‚
â”‚                                                   â”‚
â”‚ Behavior:                                         â”‚
â”‚   - Checks if user is free tier                  â”‚
â”‚   - Checks if already seen in session            â”‚
â”‚   - Uses AsyncStorage for session tracking       â”‚
â”‚   - Shows only once per login                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ useFreeUserLimitations()                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Returns:                                          â”‚
â”‚   {                                               â”‚
â”‚     canStreamWithoutAd(),                        â”‚
â”‚     canDownload(),                               â”‚
â”‚     getVideoQuality(),                           â”‚
â”‚     hasReachedDownloadLimit(),                   â”‚
â”‚     isFreeTier                                   â”‚
â”‚   }                                               â”‚
â”‚                                                   â”‚
â”‚ Usage:                                            â”‚
â”‚   const quality = getVideoQuality();             â”‚
â”‚   // Returns 'SD' or '4K'                        â”‚
â”‚                                                   â”‚
â”‚   if (hasReachedDownloadLimit) {                 â”‚
â”‚     showAlert('Download limit reached');         â”‚
â”‚   }                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ useFreeUserAds()                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Returns:                                          â”‚
â”‚   {                                               â”‚
â”‚     shouldShowAd,       // Show ad screen?       â”‚
â”‚     adWatched,          // Ad completed?         â”‚
â”‚     handleAdComplete,   // Call on finish        â”‚
â”‚     resetAd,            // Reset for next video  â”‚
â”‚     needsAdToWatch      // Free user needs ad?   â”‚
â”‚   }                                               â”‚
â”‚                                                   â”‚
â”‚ Usage:                                            â”‚
â”‚   if (needsAdToWatch) {                          â”‚
â”‚     return <RewardAdScreen                       â”‚
â”‚       onComplete={handleAdComplete}              â”‚
â”‚     />;                                          â”‚
â”‚   }                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Decision Tree: Feature Access

```
                    â”Œâ”€ Is User Premium?
                    â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                â”‚
          YES               NO
            â”‚                â”‚
            â–¼                â–¼
      âœ… ALLOW          Check Free Tier
       FEATURE           Limits
            â”‚                â”‚
            â”‚                â–¼
            â”‚          â”Œâ”€ Video Streaming?
            â”‚          â”‚
            â”‚     â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚     â”‚             â”‚
            â”‚    YES           NO
            â”‚     â”‚             â”‚
            â”‚     â–¼             â–¼
            â”‚  Need Ad?    âŒ DENY
            â”‚     â”‚        (Subscribe)
            â”‚     â–¼
            â”‚  â”Œâ”€ Ad Watched?
            â”‚  â”‚
            â”‚  â”œâ”€ YES: âœ… PLAY VIDEO
            â”‚  â””â”€ NO: ğŸ¥ SHOW AD SCREEN
            â”‚
            â”œâ”€ Download?
            â”‚     â”‚
            â”‚     â–¼
            â”‚  â”Œâ”€ <5 Downloads/mo?
            â”‚  â”‚
            â”‚  â”œâ”€ YES: âœ… ALLOW DOWNLOAD
            â”‚  â””â”€ NO: âŒ LIMIT REACHED
            â”‚
            â”œâ”€ Video Quality?
            â”‚     â”‚
            â”‚     â”œâ”€ FREE: SD (480p)
            â”‚     â””â”€ PREMIUM: 4K (2160p)
            â”‚
            â””â”€ Ad Frequency?
                  â”‚
                  â”œâ”€ FREE: Frequent ads
                  â””â”€ PREMIUM: No ads
```

---

## Revenue Flow

```
New User
    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                 â”‚
    â–¼                                 â–¼
Free Tier                      Premium Tier
    â”‚                                 â”‚
    â”œâ”€ Ad Revenue                     â”œâ”€ Subscription Revenue
    â”‚  (Google AdMob,etc)            â”‚  (Recurring Monthly/Yearly)
    â”‚  ~$0.50-2 per 1000 views        â”‚  ~$10/month
    â”‚                                 â”‚
    â”œâ”€ % Upgrade Rate                 â”œâ”€ Churn Rate
    â”‚  (Target: 15-20%)              â”‚  (Target: 5-10%)
    â”‚                                 â”‚
    â””â”€ Upsell Path                    â””â”€ Retention Path
       (Premium Upgrade)                 (Keep Subscription)
       â””â”€ Conversion: 2-5%               â””â”€ Renewal: 90-95%


Month 1 Analysis (1M Users):
â”œâ”€ Free Users: 800,000
â”‚  â””â”€ Ad Revenue: ~$400K/month
â”‚
â”œâ”€ Premium Monthly: 150,000 Ã— $9.99 = $1,498,500/month
â”‚
â””â”€ Premium Yearly: 50,000 Ã· 12 = $4,166/month revenue/user
   â””â”€ Annual Value: $500,000/month from yearly subscriptions

TOTAL: ~$2.4M/month potential revenue

Key Metrics:
â”œâ”€ CAC (Cost Acquisition): ~$2-5 per user
â”œâ”€ LTV (Lifetime Value Premium): ~$120 (12 months Ã— $10)
â”œâ”€ Free User LTV: ~$10/year (ads)
â”œâ”€ Break-even: ~1-3 months for premium users
â””â”€ Payback Period: Strong ROI after month 3-4
```

---

## State Diagram

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   NOT LOGGED   â”‚
                    â”‚    IN (NULL)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ User logs in
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  LOADING AUTH  â”‚
                    â”‚  & SUBSCRIPTIONâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ Loaded
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                  â”‚
                    â–¼                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  FREE TIER     â”‚   â”‚ PREMIUM TIER    â”‚
         â”‚  (Active)      â”‚   â”‚ (Active)        â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚ - Limited ads  â”‚   â”‚ - No ads        â”‚
         â”‚ - Reward ads   â”‚   â”‚ - Unlimited     â”‚
         â”‚ - 5 DL/month   â”‚   â”‚ - 4K quality    â”‚
         â”‚ - SD quality   â”‚   â”‚ - Auto-renews   â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
              â”‚       â”‚            â”‚       â”‚
          Upgrade  Cancel       Cancel  Renews
              â”‚       â”‚            â”‚       â”‚
              â”‚       â–¼            â”‚       â”‚
              â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
              â”‚    â”‚  FREE TIER       â”‚  â”‚
              â”‚    â”‚  (Cancelled)     â”‚  â”‚
              â”‚    â”‚  (Reverted)      â”‚  â”‚
              â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
              â”‚           â”‚              â”‚
              â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜              â”‚
                    â”‚                    â”‚
                    â–¼ Resubscribe        â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
          â”‚  PAYMENT PENDING â”‚           â”‚
          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
                 â”‚                       â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
         â”‚                  â”‚            â”‚
         SUCCESS          FAILURE        â”‚
         â”‚                  â”‚            â”‚
         â–¼                  â–¼            â–¼
    PREMIUM          REMAIN FREE   PREMIUM
    ACTIVE           TIER          CANCELLED
    (New Sub)        (No Change)    (Reverted
                                     to Free)
```

---

## Integration Sequence

```
PHASE 1: Setup
  1. âœ… Create SubscriptionContext
  2. âœ… Create subscriptionService
  3. âœ… Create subscription hooks
  4. âœ… Add to App.js providers
  5. ğŸ“ NOW: Add navigation screens

PHASE 2: Integration
  6. ğŸ“ Update SplashScreen (add upgrade prompt)
  7. ğŸ“ Update VideoPlayerScreen (add reward ads)
  8. ğŸ“ Update DownloadsScreen (add limits)
  9. ğŸ“ Update ProfileScreen (add upgrade button)
  10. ğŸ“ Test all flows

PHASE 3: Monetization
  11. â³ Integrate payment gateway
  12. â³ Set up webhooks
  13. â³ Add email notifications
  14. â³ Configure analytics

PHASE 4: Optimization
  15. â³ A/B test pricing
  16. â³ Monitor churn
  17. â³ Optimize funnels
  18. â³ Launch campaigns

ğŸ“ = Next Steps
âœ… = Completed
â³ = Future
```

---

This architecture ensures:
- âœ… Clean separation of concerns
- âœ… Reusable hooks for all screens
- âœ… Firebase integration ready
- âœ… Payment gateway agnostic
- âœ… Easy to extend and maintain

